(this.webpackJsonp=this.webpackJsonp||[]).push([[7],{912:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return j})),n.d(t,"k",(function(){return O})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return x}));var r=n(921),a=n(926),c=Object(a.Record)({name:"",team:0});function u(e){return Object.keys(e).reduce((function(t,n){return t.set(n,function(e){return c({name:e.name,team:e.team})}(e[n]))}),Object(a.Map)())}var o,i=Object(a.Record)({text:""});function s(e){return i({text:e.text})}function f(e){return Object.keys(e).reduce((function(t,n){return t.set(n,Object(a.List)(e[n].map(s)))}),Object(a.Map)())}function b(e){return Object.keys(e).reduce((function(t,n){return t.set(+n,e[n])}),Object(a.Map)())}!function(e){e[e.None=0]="None",e[e.Lobby=1]="Lobby",e[e.Started=2]="Started",e[e.Finish=3]="Finish"}(o||(o={}));var d=Object(a.Record)({state:o.None,peers:Object(a.Map)(),teams:b({0:"Team 1",1:"Team 2"}),cards:Object(a.Map)()});function l(e){return d({state:e.state,peers:u(e.peers),teams:b(e.teams),cards:f(e.cards)})}var m="game",j=d(),O=Object(r.createActionWithPayload)(m+".sync"),p=Object(r.createActionWithPayload)(m+".set-state"),h=Object(r.createActionWithPayload)(m+".set-name"),v=Object(r.createActionWithPayload)(m+".set-team"),g=Object(r.createActionWithPayload)(m+".set-team-name");function y(e,t,n){return e.update("peers",(function(e){return e.set(t,n(e.get(t)||c()))}))}function x(e,t){return h.is(t)?y(e,t.payload.id,(function(e){return e.set("name",t.payload.name)})):v.is(t)?y(e,t.payload.id,(function(e){return e.set("team",t.payload.team)})):g.is(t)?e.update("teams",(function(e){return e.set(t.payload.team,t.payload.name)})):O.is(t)?e.mergeDeep(l(t.payload)):p.is(t)?e.set("state",t.payload):e}},913:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return b}));var r=n(11),a=n.n(r),c=n(921),u=n(933),o=n(912),i=n(915),s=new c.State(a()({},o.d,o.b),a()({},o.d,o.e)),f=(Object(u.createConnect)(s),Object(u.createHook)(s)),b=Object(c.createDispatcher)(s,Object(c.mergeReducers)(a()({},o.d,o.f)));Object(i.a)().then((function(e){e.on("message",b)}))},914:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return d}));var r=n(52),a=n.n(r),c=n(264),u=n(931),o="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i="fishbowl-aicacia-com-";function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Object(c.range)(0,e).iter().map((function(){return o.charAt(Math.floor(Math.random()*o.length))})).toArray().join("")}function f(e){return i+e}function b(e){return e.substring(i.length)}function d(){var e,t,n=arguments;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:6,r.next=3,a.a.awrap(u.a.getItem("ID"));case 3:if(!(t=r.sent)){r.next=8;break}return r.abrupt("return",t);case 8:return t=s(e),r.next=11,a.a.awrap(u.a.setItem("ID",t));case 11:return r.abrupt("return",t);case 12:case"end":return r.stop()}}),null,null,null,Promise)}},915:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n(52),a=n.n(r),c=n(17),u=n.n(c),o=n(264),i=n(923),s=n(0),f=n(919),b=n(924),d=n.n(b),l=n(914),m=Object(o.none)(),j=Object(o.none)(),O=new f.EventEmitter;function p(){return new Promise((function(e){return j.ifSome(e).ifNone((function(){return O.once("peer",e)}))}))}function h(){var e=Object(s.useState)(j.toJS()),t=u()(e,2),n=t[0],r=t[1];return Object(s.useEffect)((function(){null===n&&p().then(r)}),[n]),n}!function(){var e,t;a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=l.a,n.next=3,a.a.awrap(Object(l.b)());case 3:return n.t1=n.sent,e=(0,n.t0)(n.t1),n.next=7,a.a.awrap(i.Peer.create(new d.a(e)));case 7:(t=n.sent).on("error",(function(e){console.error(e)})),m.replace(e),j.replace(t),O.emit("peer-id",e),O.emit("peer",t);case 13:case"end":return n.stop()}}),null,null,null,Promise)}()},918:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"j",(function(){return s})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return r.c})),n.d(t,"a",(function(){return r.a})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return j}));var r=n(912),a=n(913),c=n(915),u=n(935),o=n(914);function i(){var e=r.h.create(r.a.Lobby);Object(a.a)(e),Object(c.a)().then((function(t){return t.broadcast(e)}))}function s(){var e=r.h.create(r.a.Started);Object(a.a)(e),Object(c.a)().then((function(t){return t.broadcast(e)}))}var f=Object(u.debounce)((function(e,t){var n=r.j.create({team:e,name:t});Object(a.a)(n),Object(c.a)().then((function(e){return e.broadcast(n)}))}),500),b=Object(u.debounce)((function(e,t){var n=r.g.create({id:e,name:t});Object(a.a)(n),Object(c.a)().then((function(e){return e.broadcast(n)}))}),500);function d(e,t){var n=r.i.create({id:e,team:t});Object(a.a)(n),Object(c.a)().then((function(e){return e.broadcast(n)}))}function l(e){return e[r.d].state}function m(e){return e[r.d].peers}function j(e){return e[r.d].teams}Object(c.a)().then((function(e){b(e.getId(),Object(o.c)(e.getId())),e.on("connection",(function(t){var n=a.b.getCurrent().game;n.state!==r.a.None&&e.send(t,r.k.create(n.toJS()))}))}))},925:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=925},927:function(e,t,n){"use strict";n(918);var r=n(913);n.d(t,"a",(function(){return r.c}))},999:function(e,t,n){"use strict";n.r(t),n.d(t,"Lobby",(function(){return E}));var r=n(52),a=n.n(r),c=n(17),u=n.n(c),o=n(0),i=n.n(o),s=n(6),f=n(159),b=n(5),d=n(996),l=n(48),m=n(77),j=n(915),O=n(927),p=n(918),h=n(914),v=n(32),g=n(971),y=n(53),x=Object(o.memo)((function(e){var t=Object(o.useState)(),n=u()(t,2),r=n[0],a=n[1],c=e.size||512;return Object(o.useMemo)((function(){Object(g.toDataURL)(e.uri,{width:c,height:c}).then(a)}),[e.uri,c]),i.a.createElement(y.a,{source:{uri:r},style:{width:c,height:c}})})),k=n(220),w=s.a.create({qrcode:{flex:1,alignItems:"center"}});function E(e){var t=Object(j.b)(),n=Object(O.a)(p.e),r=Object(O.a)(p.d),c=Object(O.a)(p.f),s=Object(f.a)(),g=r.get(t?t.getId():"",Object(p.b)()),y=Object(o.useState)(g.name),E=u()(y,2),S=E[0],I=E[1],C=Object(o.useState)(c),N=u()(C,2),M=N[0],P=N[1],L=Object(v.useNavigation)(),T=r.filter((function(e){return 0===e.team})).toList(),D=r.filter((function(e){return 1===e.team})).toList();n===p.a.None?Object(p.c)():n!==p.a.Lobby&&L.navigate(m.b,{id:e.id}),Object(o.useMemo)((function(){return P(c)}),[c]),Object(o.useMemo)((function(){var n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=Object(h.a)(e.id),!t){r.next=10;break}if(n===t.getId()){r.next=10;break}return r.prev=3,r.next=6,a.a.awrap(t.connect(n));case 6:r.next=10;break;case 8:r.prev=8,r.t0=r.catch(3);case 10:case"end":return r.stop()}}),null,null,[[3,8]],Promise)}),[t,e.id]);var A=Object(o.useCallback)((function(e){return function(n){t&&(Object(p.i)(e,n),P((function(t){return t.set(e,n)})))}}),[t]),J=Object(o.useCallback)((function(e){t&&(Object(p.g)(t.getId(),e),I(e))}),[t]),q=Object(o.useCallback)((function(e){return function(){t&&Object(p.h)(t.getId(),e)}}),[t]);return i.a.createElement(b.a,null,i.a.createElement(l.Input,{label:"Your Name",value:S,onChangeText:J}),i.a.createElement(l.Input,{label:"Team 1 Name",value:M.get(0,""),onChangeText:A(0)}),i.a.createElement(l.Input,{label:"Team 2 Name",value:M.get(1,""),onChangeText:A(1)}),i.a.createElement(l.Divider,null),i.a.createElement(l.CheckBox,{checked:0==g.team,onChange:q(0)},(1==g.team?"Join ":"")+M.get(0,"")),T.toSeq().map((function(e,t){return i.a.createElement(l.Text,{key:t},e.name)})).valueSeq(),i.a.createElement(l.CheckBox,{checked:1==g.team,onChange:q(1)},(0==g.team?"Join ":"")+M.get(1,"")),D.toSeq().map((function(e,t){return i.a.createElement(l.Text,{key:t},e.name)})).valueSeq(),i.a.createElement(l.Button,{disabled:T.isEmpty()||D.isEmpty(),onPress:p.j},"Start"),i.a.createElement(b.a,{style:w.qrcode},i.a.createElement(x,{uri:Object(d.a)("/lobby/"+e.id),size:Object(k.c)(s.width)?k.b:s.width})))}}}]);
//# sourceMappingURL=7.7e3dccae.chunk.js.map